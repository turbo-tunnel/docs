(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{459:function(e,t,_){"use strict";_.r(t);var a=_(24),v=Object(a.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"k8s隧道"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#k8s隧道"}},[e._v("#")]),e._v(" K8S隧道")]),e._v(" "),_("h2",{attrs:{id:"功能"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[e._v("#")]),e._v(" 功能")]),e._v(" "),_("ul",[_("li",[e._v("通过K8S接口连接到集群内指定的Pod，从而去访问集群内的其它服务")])]),e._v(" "),_("h2",{attrs:{id:"使用场景"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#使用场景"}},[e._v("#")]),e._v(" 使用场景")]),e._v(" "),_("p",[e._v("这种方式是为了解决无法在K8S集群外部访问集群内尚未暴露出来的服务（内部服务）。")]),e._v(" "),_("p",[e._v("其实现原理与SSH的进程模式基本一致，都是需要用户先在POD里安装好"),_("a",{attrs:{href:"https://github.com/turbo-tunnel/telnet-go",target:"_blank",rel:"noopener noreferrer"}},[e._v("telnet"),_("OutboundLink")],1),e._v("工具，然后通过K8S的"),_("code",[e._v("exec")]),e._v("通道去执行这个命令行，从而建立与其它服务的连接。")]),e._v(" "),_("p",[e._v("虽然相比于"),_("code",[e._v("port-forward")]),e._v("方式需要额外部署一个工具，但使用这种方式的通用性更好，不需要在POD里单独部署其它的隧道服务，相对来说更安全一些。")]),e._v(" "),_("h2",{attrs:{id:"k8s隧道客户端"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#k8s隧道客户端"}},[e._v("#")]),e._v(" K8S隧道客户端")]),e._v(" "),_("div",{staticClass:"language-bash extra-class"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[e._v("$ turbo-tunnel -l http://127.0.0.1:8080 -t "),_("span",{pre:!0,attrs:{class:"token string"}},[e._v('"k8s://1.1.1.1:8443/usr/local/bin/go-telnet?namespace=test&pod=turbo-tunnel&kubeconfig=/root/kubeconfig"')]),e._v("\n")])])]),_("ul",[_("li",[_("code",[e._v("/usr/local/bin/telnet")]),e._v("是"),_("code",[e._v("telnet")]),e._v("工具在POD中的路径")]),e._v(" "),_("li",[_("code",[e._v("namespace")]),e._v(": POD所在的命名空间，默认值为"),_("code",[e._v("default")])]),e._v(" "),_("li",[_("code",[e._v("pod")]),e._v(": POD的名字")]),e._v(" "),_("li",[_("code",[e._v("kubeconfig")]),e._v(": kubeconfig文件路径")]),e._v(" "),_("li",[_("code",[e._v("client_cert")]),e._v(": 客户端证书文件路径")]),e._v(" "),_("li",[_("code",[e._v("client_key")]),e._v(": 客户端key文件路径")]),e._v(" "),_("li",[_("code",[e._v("ca_cert")]),e._v(": CA证书文件路径")])]),e._v(" "),_("p",[e._v("如果没有kubeconfig文件，也可以通过指定"),_("code",[e._v("client_cert")]),e._v(" + "),_("code",[e._v("client_key")]),e._v(" + "),_("code",[e._v("ca_cert")]),e._v("这三个参数来代替"),_("code",[e._v("kubeconfig")]),e._v("参数。")])])}),[],!1,null,null,null);t.default=v.exports}}]);